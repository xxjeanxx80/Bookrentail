# Enable URL rewriting
RewriteEngine On
RewriteBase /Bookrentail/

# Redirect pages/Admin/* to Admin/*
RewriteRule ^pages/Admin/(.*)$ Admin/$1 [R=301,L]

# Handle root request to pages/index.php (if not a real file/directory)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^$ pages/index.php [L]

# Handle direct access to pages directory
# E.g., /Bookrentail/pages/bookCategory.php -> /Bookrentail/bookCategory.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^pages/([a-zA-Z0-9_-]+)\.php$ $1.php [L,QSA]

# Handle clean URLs for pages (friendly URLs)
# E.g., /Bookrentail/bookCategory -> /Bookrentail/pages/bookCategory.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9_-]+)/?$ pages/$1.php [L,QSA]

# Handle clean URLs with numeric parameters
# E.g., /Bookrentail/bookCategory/123 -> /Bookrentail/pages/bookCategory.php?id=123
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9_-]+)/([0-9]+)/?$ pages/$1.php?id=$2 [L,QSA]

# Handle any other missing files by trying to map to pages directory
# This is a fallback for parameters or complex URLs
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ pages/$1 [L,QSA]

# Security: Disable directory browsing
Options -Indexes

# Security: Prevent access to .htaccess file
<Files .htaccess>
Order allow,deny
Deny from all
</Files>

# Security: Prevent access to sensitive files
<FilesMatch "\.(log|sql|conf|ini|bak|backup)$">
Order allow,deny
Deny from all
</FilesMatch>
